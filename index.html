<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TAPENOVA Ã— IR</title>
    <link rel="icon" type="image/png" href="tapenovair.png" />
    <link rel="apple-touch-icon" href="tapenovair.png" />
    <link rel="stylesheet" href="style.css" />
</head>
<body>
    <!-- Ambient audio-reactive colour orbs (behind the player) -->
    <div class="ambient-bg">
        <div class="orb orb-1" id="orb1"></div>
        <div class="orb orb-2" id="orb2"></div>
        <div class="orb orb-3" id="orb3"></div>
    </div>

    <div class="player-container">

        <!-- Player top bar: view tabs + theme toggle -->
        <div class="player-topbar">
            <div class="view-tabs">
                <button class="view-tab active" id="tabCassette" title="Cassette view">ðŸ“¼</button>
                <button class="view-tab"        id="tabVinyl"    title="Vinyl view">ðŸ’¿</button>
            </div>
            <button id="themeToggle" class="theme-toggle" title="Toggle light / dark mode">â˜€</button>
        </div>

        <!-- â•â•â• VIEW A: WALKMAN (cassette) â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div class="walkman-body" id="viewCassette">

            <!-- Brand strip -->
            <div class="walkman-brand">
                <span class="wb-logo">TAPENOVA Ã— IR</span>
                <span class="wb-led" id="wbLed"></span>
            </div>

            <!-- Cassette compartment â€” perspective context + hinged lid -->
            <div class="cassette-compartment">

                <!-- Lid: rotates backward (rotateX) when open, hinge at top -->
                <div class="compartment-lid" id="compartmentLid">
                    <div class="lid-hinge"></div>
                </div>

                <!-- Cassette scene (perspective wrapper; cassette ejects inside this) -->
                <div class="cassette-scene">
                <div class="cassette">
                    <!-- Three-column row: left reel | centre label | right reel -->
                    <div class="cassette-body">
                        <div class="reel-well">
                            <div class="reel reel-left">
                                <div class="reel-tape"></div>
                                <div class="hub"></div>
                            </div>
                        </div>
                        <div class="cassette-label">
                            <!-- Default sticker shown when no album art is embedded -->
                            <div class="sticker" id="sticker">
                                <span class="sticker-brand">TAPENOVA Ã— IR</span>
                                <span class="sticker-reels">â—‰&nbsp;&nbsp;â—‰</span>
                                <span class="track-title" id="trackTitle">â”€â”€â”€â”€â”€â”€â”€</span>
                            </div>
                            <!-- Album art overlay â€” hidden until art is extracted -->
                            <img class="album-art" id="albumArt" alt="" />
                            <!-- Track title shown on top of album art -->
                            <div class="art-title" id="artTitle"></div>
                        </div>
                        <div class="reel-well">
                            <div class="reel reel-right">
                                <div class="reel-tape"></div>
                                <div class="hub"></div>
                            </div>
                        </div>
                    </div>
                    <!-- Tape path â€” the horizontal slot where tape is visible moving -->
                    <div class="tape-path">
                        <div class="tape-strand"></div>
                    </div>
                </div>
                </div><!-- /.cassette-scene -->

            </div><!-- /.cassette-compartment -->

        </div><!-- /.walkman-body / #viewCassette -->

        <!-- â•â•â• VIEW B: VINYL TURNTABLE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div class="vinyl-body" id="viewVinyl" hidden>
            <div class="turntable-surface">

                <!-- Left: platter + vinyl record -->
                <div class="platter-wrap">
                    <div class="platter">
                        <!-- The record â€” rotates during playback -->
                        <div class="vinyl" id="vinylDisc">
                            <div class="vinyl-label" id="vinylLabel">
                                <img class="vinyl-art" id="vinylArtImg" alt="" />
                                <div class="vinyl-label-default" id="vinylLabelDefault">
                                    <span class="vl-brand">TAPENOVA</span>
                                    <span class="vl-sub">Ã— IR</span>
                                </div>
                                <div class="vinyl-spindle"></div>
                            </div>
                        </div>
                        <!-- Shine overlay: sibling of vinyl so it does NOT rotate -->
                        <div class="vinyl-shine"></div>
                    </div>
                </div>

                <!-- Right: tonearm assembly -->
                <div class="tonearm-area">
                    <div class="tonearm-base"></div>
                    <div class="tonearm-wrapper" id="tonearmEl">
                        <div class="tonearm-arm"></div>
                        <div class="tonearm-headshell">
                            <div class="tonearm-stylus"></div>
                        </div>
                    </div>
                </div>

                <!-- Sound wave container -->
                <div class="sound-wave-container" id="soundWaveContainer"></div>

            </div>
        </div><!-- /.vinyl-body / #viewVinyl -->

        <!-- â•â•â• SHARED: display + transport (below both views) â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <!-- Display panel (track name + meta) -->
        <div class="walkman-display">
            <div class="track-name" id="trackName">No track loaded</div>
            <div class="track-meta" id="trackMeta">Drop audio files here or click Load</div>
        </div>

        <!-- Transport controls -->
        <div class="walkman-transport">
            <input type="file" id="fileInput" accept="audio/*" multiple class="file-input" />
            <label for="fileInput" class="transport-btn tb-load">&#9167;</label>
            <button id="prev"      class="transport-btn" disabled>&#9198;</button>
            <button id="stop"      class="transport-btn" disabled>&#9632;</button>
            <button id="playPause" class="transport-btn play-btn" disabled>&#9654;</button>
            <button id="next"      class="transport-btn" disabled>&#9197;</button>
        </div>

        <!-- Seek bar -->
        <div class="seek-container">
            <input type="range" id="seekBar" class="seek-bar" min="0" max="100" value="0" step="0.1" disabled />
            <div class="time-display">
                <span id="currentTime">00:00</span>
                <span id="duration">00:00</span>
            </div>
        </div>

        <!-- YouTube URL input -->
        <div class="yt-section">
            <span class="yt-badge">YT</span>
            <input type="text" id="ytUrlInput" class="yt-url-input"
                   placeholder="Paste a YouTube URLâ€¦" autocomplete="off" spellcheck="false" />
            <button id="ytLoadBtn" class="yt-load-btn">Play</button>
        </div>

        <!-- Audio info -->
        <div class="info">
            <div class="info-item">
                <span class="info-label">Sample Rate</span>
                <span class="info-value"><span id="sampleRate">-</span> kHz</span>
            </div>
            <div class="info-item">
                <span class="info-label">Bit Depth</span>
                <span class="info-value"><span id="bitDepth">-</span> bits</span>
            </div>
            <div class="info-item">
                <span class="info-label">Bitrate</span>
                <span class="info-value"><span id="bitrate">-</span> kbps</span>
            </div>
        </div>

        <!-- Playlist -->
        <div class="playlist-section">
            <div class="playlist-header">Queue <span id="queueCount">(0)</span></div>
            <ul id="playlist" class="playlist"></ul>
        </div>

        <audio id="audioElement"></audio>
    </div>
    <!-- Hidden YouTube IFrame Player container -->
    <div id="ytPlayerEl" aria-hidden="true"></div>
    <script src="script.js"></script>
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/service-worker.js').catch(console.error);
        }
    </script>
</body>
</html>
